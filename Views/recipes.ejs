<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <%- include('meta.ejs'); %>

</head>

<body>

    <%- include('header.ejs'); %>
        <!-- Subheader Start -->
        <div class="metro_subheader dark-overlay dark-overlay-2"
            style="background-image: url(assets/img/banners/banner-1.jpg)">
            <div class="container">
                <div class="metro_subheader-inner">
                    <h1>Recipe Details</h1>
                </div>
            </div>
        </div>
        <!-- Subheader End -->

        <!-- Post Content Start -->
        <div class="section metro_post-single">
            <div class="container">

                <div class="row1">
                    <div class="col-lg-8">

                        <!-- Content  -->
                        <div class="metro_post-single-wrapper metro_recipe-single-wrapper">
                            <h1 id="recipeName"></h1>
                            <h2 class="entry-title"></h2>

                            <div class="metro_post-single-thumb">
                                <img id="recipeImage" src="" alt="post">
                            </div>

                            <!-- Entry Content Start -->
                            <div class="entry-content">
                                <span class="metro_post-meta">
                                    <i id="authorName" class="far fa-user"></i>
                                    <i id="totalTime" class="far fa-clock"></i>
                                </span>

                                <p id="recipeDescription">

                                </p>

                                <p id="recipeInstructions">

                                </p>

                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="metro_nutritional-facts">
                                            <h4>Nutrition</h4>
                                            <ul>
                                                <li> Calories: <span id= "calories"></span> </li>
                                                <li> Sugar: <span id="sugar"></span> </li>
                                                <li> Protein: <span id="protein"></span> </li>
                                                <li> Fat: <span id="fat"></span> </li>
                                                <li> Carbs: <span id="carbs"></span> </li>
                                                <li> Cholestorol: <span id="cholestorol"></span> </li>
                                                <li> Fiber: <span id="fiber"></span> </li>
                                                <li> Saturated Fat: <span id="satFat"></span> </li>
                                                <li> Sodium: <span id="sodium"></span> </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="metro_ingredients">
                                            <h4>Ingredients</h4>
                                            <ul id="ingredient">
                                                
                                                
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Entry Content End -->

                        </div>

                        <!-- Comments Form -->
                        <div class="metro_comments-list">
                            <h4>Our Comments</h4>
                            <ul>
                                <li class="comment-item">
                                    <img src="assets/img/people/avatar-0.png" alt="comment author">
                                    <div id="commentBody" class="comment-body">
                                        
                                    </div>
                                    <ul>
                                        <li class="comment-item">
                                            <img src="assets/img/people/avatar-0.png" alt="comment author">
                                            <div class="comment-body">
                                                <h5>John</h5>
                                                <span>January 13 2020</span>
                                                <p>Same, I had one of the best eggs in my life</p>
                                                <a href="#" class="btn-link"> Reply <i class="fas fa-arrow-right"></i>
                                                </a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li class="comment-item">
                                    <img src="assets/img/people/avatar-0.png" alt="comment author">
                                    <div class="comment-body">
                                        <h5>Mich</h5>
                                        <span>January 13 2020</span>
                                        <p>Love the egg, would prefer it to be more flavourful by adding a little citrus</p>
                                        <a href="#" class="btn-link"> Reply <i class="fas fa-arrow-right"></i> </a>
                                    </div>
                                </li>
                            </ul>
                        </div>

                        <!-- Comments -->
                        <div class="metro_comments-form">

                            <h4>Leave a Comment</h4>

                            <form method="post">
                                <div class="form-group">
                                    <input type="text" class="form-control" placeholder="Full Name" name="fname"
                                        value="">
                                    <i class="far fa-user"></i>
                                </div>
                                <div class="form-group">
                                    <input type="email" class="form-control" placeholder="Email Address" name="email"
                                        value="">
                                    <i class="far fa-user"></i>
                                </div>
                                <div class="form-group">
                                    <textarea class="form-control" placeholder="Type your comment..." name="comment"
                                        rows="7"></textarea>
                                    <i class="far fa-envelope"></i>
                                </div>
                                <div class="form-group d-flex" style="text-align: left;">
                                    <label for="rate d-inline-block" style="font-size: 1.5em;">Rating:</label>
                                    <div class="rate" id="rate">
                                        <input type="radio" id="star5" name="rate" value="5" />
                                        <label for="star5" title="text">5 stars</label>
                                        <input type="radio" id="star4" name="rate" value="4" />
                                        <label for="star4" title="text">4 stars</label>
                                        <input type="radio" id="star3" name="rate" value="3" />
                                        <label for="star3" title="text">3 stars</label>
                                        <input type="radio" id="star2" name="rate" value="2" />
                                        <label for="star2" title="text">2 stars</label>
                                        <input type="radio" id="star1" name="rate" value="1" />
                                        <label for="star1" title="text">1 star</label>
                                    </div>
                                </div>

                                <button type="submit" class="metro_btn-custom primary" name="button">Send
                                    Comment</button>
                            </form>
                        </div>

                    </div>

                </div>

            </div>
        </div>
        <!-- Product Content End -->

        <%- include('footer.ejs') %>

            <!-- Vendor Scripts -->
            <script src="assets/js/plugins/jquery-3.4.1.min.js"></script>
            <script src="assets/js/plugins/popper.min.js"></script>
            <script src="assets/js/plugins/waypoint.js"></script>
            <script src="assets/js/plugins/bootstrap.min.js"></script>
            <script src="assets/js/plugins/jquery.magnific-popup.min.js"></script>
            <script src="assets/js/plugins/jquery.slimScroll.min.js"></script>
            <script src="assets/js/plugins/imagesloaded.min.js"></script>
            <script src="assets/js/plugins/jquery.steps.min.js"></script>
            <script src="assets/js/plugins/jquery.countdown.min.js"></script>
            <script src="assets/js/plugins/isotope.pkgd.min.js"></script>
            <script src="assets/js/plugins/slick.min.js"></script>
            <script src="assets/js/plugins/ion.rangeSlider.min.js"></script>
            <script src="assets/js/plugins/jquery.zoom.min.js"></script>


            <!-- Organista Scripts -->
            <script src="assets/js/main.js"></script>

            <script>

                window.onload = function () {

                    var urlParams = new URLSearchParams(window.location.search);
                    if (urlParams.has('recipeID')) {
                        var query = urlParams.get('recipeID')

                        console.log(query)

                        $.ajax({
                            type: "POST",
                            url: "/recipes/details",
                            data: {
                                recipeID: query
                            },
                            success: function (result) {
                                console.log(result)
                                console.log(result[0].image.split(", ")[0])
                                $('#recipeName').append(result[0].recipeName);
                                $('#recipeImage').prop("src", result[0].image.split(", ")[0]);
                                $('#authorName').append(" " + result[0].authorName + " ");
                                $('#totalTime').append(" " + result[0].totalTime);
                                $('#recipeDescription').append(" " + result[0].description);
                                $('#recipeInstructions').append(" " + result[0].instructions.replaceAll(".,", "</br>"));
                                $('#calories').append(result[0].calories);
                                $('#sugar').append(result[0].sugarContent);
                                $('#protein').append(result[0].proteinContent);
                                $('#fat').append(result[0].fatContent);
                                $('#carbs').append(result[0].carboContent);
                                $('#cholestorol').append(result[0].cholestorolContent);
                                $('#fiber').append(result[0].fiberContent);
                                $('#satFat').append(result[0].satFatContent);
                                $('#sodium').append(result[0].sodium);
                                $('#ingredient').append("<li>" + result[0].ingredientName.replaceAll(", ","</li><li>"));

                                if(result[0].RecipeDetails[0]){
                                    $("#commentBody").append('<h5 id="reviewerName">'+result[0].RecipeDetails[0].reviewAuthorName+'</h5>'+
                                        '<span id="reviewDate">'+result[0].RecipeDetails[0].dateModified+'</span>'+
                                        '<p id="review">'+result[0].RecipeDetails[0].reviewDesc+'</p>'+
                                        '<a href="#" class="btn-link"> Reply <i class="fas fa-arrow-right"></i> </a>')
                                }
                                else{
                                    $("#commentBody").append('<h5 id="reviewerName">No Review</h5>')
                                }
                            }
                        });
                    }
                }
                $(document).keyup(function (event) {
                    if ($("#searchField").is(":focus") && event.key == "Enter") {
                        window.location.replace("/recipes/search-result?search=" + $("#searchField").val())
                    }
                });
            </script>


</body>

</html>